/* =====================================================================
   PMU Fault Classifier — style.css
   Apple Frosted Glass Design System — dark & light via CSS custom props
   ===================================================================== */

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Fira+Code:wght@400;500&display=swap');

html, body, [class*="css"] {
    font-family: "Inter", -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
}

/* ── App shell ─────────────────────────────────────────────────────── */
.stApp {
    background-color: var(--bg-color) !important;
    background-image:
        radial-gradient(ellipse 80% 50% at 20% 10%, var(--accent-glow-soft) 0%, transparent 60%),
        radial-gradient(ellipse 60% 40% at 80% 90%, rgba(129,140,248,0.06) 0%, transparent 60%) !important;
    min-height: 100vh;
}
.stAppHeader, .stApp [data-testid="stHeader"] { background-color: transparent !important; }
.stApp, .stApp p,
.stApp h1, .stApp h2, .stApp h3, .stApp h4, .stApp h5, .stApp h6,
.stApp label, .stApp li { color: var(--text-color) !important; }
.stApp [data-testid="stMetricValue"] { color: var(--accent-color) !important; }
.stApp .fault-badge, .stApp .prob-bar-wrap span { color: inherit !important; }

/* ── Sidebar — frosted glass panel ──────────────────────────────── */
[data-testid="stSidebar"] {
    background: var(--sidebar-bg) !important;
    border-right: 1px solid var(--glass-border) !important;
    backdrop-filter: blur(28px) saturate(180%) brightness(1.02) !important;
    -webkit-backdrop-filter: blur(28px) saturate(180%) brightness(1.02) !important;
    box-shadow: 2px 0 40px var(--shadow-color) !important;
}
[data-testid="stSidebar"]::after {
    content: "";
    position: absolute; inset: 0 0 0 auto;
    width: 1px;
    background: linear-gradient(180deg,
        var(--glass-border-top) 0%,
        var(--glass-border) 50%,
        transparent 100%);
    pointer-events: none;
}
[data-testid="stSidebar"] h1,[data-testid="stSidebar"] h2,
[data-testid="stSidebar"] p,[data-testid="stSidebar"] label,
[data-testid="stSidebar"] span { color: var(--text-color) !important; }

/* ── Metric cards — layered glass ──────────────────────────────── */
div[data-testid="metric-container"] {
    background: var(--metric-bg) !important;
    border: 1px solid var(--glass-border);
    border-top: 1px solid var(--glass-border-top);
    border-radius: 18px; padding: 20px 24px;
    /* multi-layer shadow: ambient + direct + glow */
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 1px 3px var(--shadow-ambient),
        0 6px 20px var(--shadow-color),
        0 20px 40px var(--shadow-ambient);
    backdrop-filter: blur(20px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
    transition: transform 0.28s cubic-bezier(0.25,0.8,0.25,1),
                box-shadow 0.28s ease, border-color 0.28s ease;
}
div[data-testid="metric-container"]:hover {
    transform: translateY(-5px) scale(1.01);
    border-color: var(--accent-color);
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 2px 6px var(--shadow-ambient),
        0 12px 32px var(--shadow-hover),
        0 0 0 1px var(--accent-color),
        0 0 24px var(--accent-glow);
}
div[data-testid="metric-container"] label {
    color: var(--text-muted) !important; font-size: 0.75rem;
    font-weight: 600; text-transform: uppercase; letter-spacing: 1px;
}
div[data-testid="metric-container"] [data-testid="stMetricValue"] {
    color: var(--accent-color) !important; font-size: 1.9rem; font-weight: 800;
    text-shadow: 0 0 20px var(--accent-glow);
}

/* ── Section header ─────────────────────────────────────────────── */
.section-header {
    font-size: 1.15rem; font-weight: 700; color: var(--text-color) !important;
    margin-bottom: 0.75rem;
    border-left: 4px solid var(--accent-color); padding-left: 12px;
    letter-spacing: 0.3px;
}

/* ── Fault badges ────────────────────────────────────────────────── */
.fault-badge {
    display: inline-block; padding: 5px 14px;
    border-radius: 9999px; font-weight: 700; font-size: 0.875rem;
    margin-bottom: 8px; box-shadow: 0 3px 10px var(--shadow-color);
    border: 1px solid rgba(255,255,255,0.08); letter-spacing: 0.3px;
}
.badge-NORMAL            { background: var(--badge-normal-bg); color: var(--badge-normal-text) !important; }
.badge-SLG_FAULT         { background: var(--badge-slg-bg);    color: var(--badge-slg-text) !important; }
.badge-LL_FAULT          { background: var(--badge-ll-bg);     color: var(--badge-ll-text) !important; }
.badge-THREE_PHASE_FAULT { background: var(--badge-3p-bg);     color: var(--badge-3p-text) !important; }
.badge-UNKNOWN           { background: var(--badge-unk-bg);    color: var(--badge-unk-text) !important; }

/* ── Probability bar ─────────────────────────────────────────────── */
.prob-bar-wrap { background: var(--bar-bg); border-radius: 8px; height: 14px;
    overflow: hidden; margin: 4px 0; box-shadow: inset 0 2px 4px rgba(0,0,0,0.08); }
.prob-bar-fill { height: 100%; border-radius: 8px;
    transition: width 0.4s cubic-bezier(0.4,0,0.2,1); }

/* ── Log box ─────────────────────────────────────────────────────── */
.log-box {
    background: var(--log-bg);
    border: 1px solid var(--glass-border);
    border-top-color: var(--glass-border-top);
    border-radius: 14px; padding: 14px;
    font-family: "Fira Code", "Consolas", monospace; font-size: 0.8rem;
    color: var(--log-text) !important; max-height: 380px; overflow-y: auto;
    white-space: pre-wrap;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        inset 0 4px 12px var(--shadow-color);
    scrollbar-width: thin; scrollbar-color: var(--glass-border) transparent;
}
.log-box::-webkit-scrollbar { width: 5px; }
.log-box::-webkit-scrollbar-track { background: transparent; }
.log-box::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 3px; }

/* Remove focus rings on all interactive elements */
.stButton > button:focus,
.stButton > button:focus-visible {
    outline: none !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 -1px 0 rgba(0,0,0,0.06) inset,
        0 1px 3px var(--shadow-ambient),
        0 4px 14px var(--shadow-color) !important;
}

/* ── Buttons — Apple frosted glass ──────────────────────────────── */
.stButton > button {
    background: var(--glass-bg) !important;
    border: 1px solid var(--glass-border) !important;
    border-top-color: var(--glass-border-top) !important;
    border-radius: 12px !important;
    font-weight: 600 !important; font-size: 0.875rem !important;
    color: var(--text-color) !important; padding: 0.55rem 1.25rem !important;
    backdrop-filter: blur(20px) saturate(200%) !important;
    -webkit-backdrop-filter: blur(20px) saturate(200%) !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 -1px 0 rgba(0,0,0,0.06) inset,
        0 1px 3px var(--shadow-ambient),
        0 4px 14px var(--shadow-color) !important;
    transition:
        transform 0.18s cubic-bezier(0.25,0.8,0.25,1),
        box-shadow 0.18s ease,
        background 0.18s ease,
        border-color 0.18s ease,
        color 0.18s ease !important;
    letter-spacing: 0.2px !important;
}
.stButton > button:hover {
    transform: translateY(-1px) !important;
    background: rgba(30,41,59,0.80) !important;
    border-color: var(--glass-border-top) !important;
    border-top-color: var(--glass-border-top) !important;
    color: var(--text-color) !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 3px 8px var(--shadow-ambient),
        0 8px 24px var(--shadow-hover) !important;
}
.stButton > button:active {
    transform: translateY(0) scale(0.975) !important;
    background: rgba(30,41,59,0.96) !important;
    border-color: var(--glass-border-top) !important;
    color: var(--text-color) !important;
    box-shadow:
        0 1px 0 rgba(0,0,0,0.20) inset,
        0 1px 4px var(--shadow-color) !important;
}
/* Primary button — inherits default glass; sidebar active uses nav-active HTML class */

/* ── Training status animated badge ─────────────────────────────── */
.train-running-badge {
    display: inline-flex; align-items: center; gap: 8px;
    background: var(--accent-glow-soft);
    border: 1px solid var(--accent-color); border-radius: 9999px;
    padding: 7px 18px; font-weight: 600; font-size: 0.875rem;
    color: var(--accent-color) !important;
    animation: pulse-badge 1.8s ease-in-out infinite;
}
@keyframes pulse-badge {
    0%,100% { box-shadow: 0 0 0 0 var(--accent-glow); }
    50%      { box-shadow: 0 0 0 5px transparent; }
}
.train-dot {
    width: 8px; height: 8px; border-radius: 50%;
    background: var(--accent-color);
    animation: dot-blink 1.2s ease-in-out infinite;
}
@keyframes dot-blink {
    0%,100% { opacity:1; transform:scale(1); }
    50%      { opacity:0.4; transform:scale(0.7); }
}

/* ── Expander — glass card ───────────────────────────────────────── */
.streamlit-expanderHeader {
    font-weight: 600 !important; font-size: 0.95rem !important;
    color: var(--text-color) !important; background: var(--glass-bg) !important;
    border-radius: 14px !important;
    backdrop-filter: blur(20px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
    border: 1px solid var(--glass-border) !important;
    border-top-color: var(--glass-border-top) !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 2px 8px var(--shadow-ambient),
        0 6px 16px var(--shadow-color) !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
}
.streamlit-expanderHeader:hover {
    border-color: var(--accent-color) !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 4px 12px var(--shadow-color),
        0 0 12px var(--accent-glow) !important;
}
div[data-testid="stExpander"] { border: none !important; background: transparent !important; }
div[data-testid="stExpanderDetails"] {
    border: 1px solid var(--glass-border) !important; border-top: none !important;
    border-bottom-left-radius: 14px !important; border-bottom-right-radius: 14px !important;
    background: var(--card-bg) !important;
    backdrop-filter: blur(16px) saturate(160%) !important;
    -webkit-backdrop-filter: blur(16px) saturate(160%) !important;
    padding: 1.1rem !important;
}

/* ── Tab content fade-in animation ──────────────────────────────── */
[data-baseweb="tab-panel"] {
    animation: tabFadeIn 0.22s cubic-bezier(0.25,0.8,0.25,1) forwards;
}
@keyframes tabFadeIn {
    from { opacity: 0; transform: translateY(7px); }
    to   { opacity: 1; transform: translateY(0); }
}

/* ── Tabs — pill switcher ────────────────────────────────────────── */
.stTabs [data-baseweb="tab-list"] {
    position: relative !important;
    background: var(--glass-bg) !important;
    border-radius: 14px !important;
    border: 1px solid var(--glass-border) !important;
    border-top-color: var(--glass-border-top) !important;
    padding: 4px !important; gap: 3px !important;
    backdrop-filter: blur(20px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
    overflow: visible !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 2px 8px var(--shadow-ambient),
        0 6px 20px var(--shadow-color) !important;
}
.stTabs [data-baseweb="tab"] {
    border-radius: 10px !important; font-weight: 600 !important; font-size: 0.875rem !important;
    color: var(--text-muted) !important; background: transparent !important;
    border: 1px solid transparent !important;
    position: relative !important; z-index: 1 !important;
    transition:
        color 0.22s ease,
        background 0.22s ease,
        border-color 0.22s ease,
        box-shadow 0.22s ease !important;
    padding: 0.5rem 1.1rem !important;
}
.stTabs [data-baseweb="tab"]:hover {
    color: var(--text-color) !important;
    background: rgba(255,255,255,0.06) !important;
}
.stTabs [aria-selected="true"] {
    position: relative !important; z-index: 1 !important;
    background: rgba(30,41,59,0.95) !important;
    border: 1px solid var(--glass-border-top) !important;
    color: var(--text-color) !important;
    font-weight: 700 !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 2px 8px rgba(0,0,0,0.30) !important;
}
/* remove all tab underline indicators */
.stTabs [data-baseweb="tab-border"],
.stTabs [data-baseweb="tab-highlight"],
.stTabs [role="tab"]::after,
.stTabs [role="tab"][aria-selected="true"]::after { display: none !important; height: 0 !important; }

/* ── Data table — glass card ─────────────────────────────────────── */
[data-testid="stDataFrame"] {
    border-radius: 16px !important; overflow: hidden !important;
    border: 1px solid var(--glass-border) !important;
    border-top-color: var(--glass-border-top) !important;
    backdrop-filter: blur(12px) !important;
    -webkit-backdrop-filter: blur(12px) !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 2px 6px var(--shadow-ambient),
        0 8px 24px var(--shadow-color) !important;
}

/* ── Inputs ──────────────────────────────────────────────────────── */
.stTextInput > div > div > input,
.stNumberInput > div > div > input {
    background: var(--input-bg) !important; border: 1px solid var(--border-color) !important;
    border-radius: 10px !important; color: var(--text-color) !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
}
.stTextInput > div > div > input:focus,
.stNumberInput > div > div > input:focus {
    border-color: var(--accent-color) !important;
    box-shadow: 0 0 0 3px var(--accent-glow) !important; outline: none !important;
}

/* ── Progress bar ────────────────────────────────────────────────── */
.stProgress > div > div > div > div {
    background: linear-gradient(90deg, var(--accent-color), var(--accent-alt)) !important;
    border-radius: 9999px !important; transition: width 0.4s ease !important;
}
.stProgress > div > div > div { background: var(--bar-bg) !important; border-radius: 9999px !important; }

/* ── Alerts ──────────────────────────────────────────────────────── */
.stAlert { border-radius: 12px !important; border-left-width: 4px !important; }

/* ── Global scrollbar ────────────────────────────────────────────── */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

/* ── Sidebar navigation — unified glass container ───────────────── */
.sidebar-nav {
    display: flex;
    flex-direction: column;
    position: relative;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-top-color: var(--glass-border-top);
    border-radius: 14px;
    overflow: visible;
    padding: 4px;
    gap: 2px;
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 2px 8px var(--shadow-ambient),
        0 6px 20px var(--shadow-color);
    margin: 0.35rem 0;
}
.nav-item {
    display: block;
    padding: 0.65rem 1rem;
    text-align: center;
    color: var(--text-muted);
    text-decoration: none !important;
    font-weight: 500;
    font-size: 0.875rem;
    letter-spacing: 0.15px;
    border-radius: 10px;
    position: relative;
    z-index: 1;
    border: 1px solid transparent;
    transition: color 0.18s ease;
    cursor: pointer;
}
.nav-item:hover {
    color: var(--text-color);
    background: rgba(255,255,255,0.045);
    text-decoration: none !important;
}
/* active: fallback (before JS loads the sliding pill) */
.nav-active {
    background: rgba(30,41,59,0.92);
    border-color: var(--glass-border-top);
    color: var(--text-color) !important;
    font-weight: 700;
    box-shadow: 0 1px 0 var(--glass-border-top) inset, 0 2px 8px rgba(0,0,0,0.28);
}
.nav-active:hover { background: rgba(30,41,59,0.92) !important; }

/* ── Radio — pill switcher (exact same pattern as tab-list / tab) ──── */
/* Container — mirrors .stTabs [data-baseweb="tab-list"] */
[data-testid="stRadio"] > div:last-child {
    position: relative !important;
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: nowrap !important;
    background: var(--glass-bg) !important;
    border-radius: 14px !important;
    border: 1px solid var(--glass-border) !important;
    border-top-color: var(--glass-border-top) !important;
    padding: 4px !important;
    gap: 3px !important;
    backdrop-filter: blur(20px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
    overflow: visible !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 2px 8px var(--shadow-ambient),
        0 6px 20px var(--shadow-color) !important;
}
/* Item — mirrors .stTabs [data-baseweb="tab"] */
[data-testid="stRadio"] [data-baseweb="radio"] {
    border-radius: 10px !important;
    font-weight: 600 !important;
    font-size: 0.875rem !important;
    color: var(--text-muted) !important;
    background: transparent !important;
    border: 1px solid transparent !important;
    position: relative !important;
    z-index: 1 !important;
    padding: 0.72rem 1.4rem !important;
    cursor: pointer !important;
    transition:
        color 0.22s ease,
        background 0.22s ease,
        border-color 0.22s ease,
        box-shadow 0.22s ease !important;
    outline: none !important;
}
[data-testid="stRadio"] [data-baseweb="radio"]:hover {
    color: var(--text-color) !important;
    background: rgba(255,255,255,0.06) !important;
}
/* Active item — mirrors .stTabs [aria-selected="true"] */
[data-testid="stRadio"] [data-baseweb="radio"]:has(input:checked) {
    background: rgba(30,41,59,0.95) !important;
    border: 1px solid var(--glass-border-top) !important;
    color: var(--text-color) !important;
    font-weight: 700 !important;
    box-shadow:
        0 1px 0 var(--glass-border-top) inset,
        0 2px 8px rgba(0,0,0,0.30) !important;
}
/* Hide circle indicator and raw input */
[data-testid="stRadio"] [data-baseweb="radio"] > div:first-child,
[data-testid="stRadio"] [data-baseweb="radio"] input { display: none !important; }
/* Label fills the wrapper, inherits all colour/weight */
[data-testid="stRadio"] [data-baseweb="radio"] label,
[data-testid="stRadio"] [data-baseweb="radio"] label * {
    display: inline !important;
    padding: 0 !important;
    margin: 0 !important;
    border: none !important;
    background: transparent !important;
    color: inherit !important;
    font-weight: inherit !important;
    font-size: inherit !important;
    cursor: pointer !important;
    user-select: none !important;
    white-space: nowrap !important;
}
/* ── Sliding pill indicator (JS-injected .sp-pill) ─────────────── */
.sp-pill {
    position: absolute;
    background: rgba(30,41,59,0.95);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.14);
    box-shadow:
        0 1px 0 rgba(255,255,255,0.14) inset,
        0 2px 8px rgba(0,0,0,0.30);
    pointer-events: none;
    z-index: 0;
    opacity: 0;
    transition:
        left   0.26s cubic-bezier(0.25,0.8,0.25,1),
        top    0.26s cubic-bezier(0.25,0.8,0.25,1),
        width  0.26s cubic-bezier(0.25,0.8,0.25,1),
        height 0.26s cubic-bezier(0.25,0.8,0.25,1),
        opacity 0.18s ease;
}
/* once JS pill is ready, suppress CSS active backgrounds (pill takes over) */
[data-baseweb="tab-list"].sp-ready [aria-selected="true"] {
    background: transparent !important;
    border-color: transparent !important;
    box-shadow: none !important;
}
[data-testid="stRadio"] > div.sp-ready [data-baseweb="radio"]:has(input:checked) {
    background: transparent !important;
    border-color: transparent !important;
    box-shadow: none !important;
    color: var(--text-color) !important;
}
.sidebar-nav.sp-ready .nav-active {
    background: transparent !important;
    border-color: transparent !important;
    box-shadow: none !important;
}
